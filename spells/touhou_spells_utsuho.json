[
  {
    "id": "utsuho_blacksun",
    "type": "SPELL",
    "name": { "str": "Create black sun" },
    "description": "Snap your fingers to create a nearby black sun that produces some light.  These can duplicate <color_yellow>Hell Wave Cannon</color> after you cast it.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_blacksun_eoc",
    "shape": "blast",
    "max_level": 1,
    "min_duration": { "math": [ "var_blacksun_dur" ] },
    "max_duration": 24000,
    "difficulty": -12,
    "base_casting_time": 200,
    "base_energy_cost": 100,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ]
  },
  {
    "id": "utsuho_blacksun2",
    "type": "SPELL",
    "name": { "str": "Create black sun" },
    "description": "Snap your fingers to create a nearby black sun that produces some light.  These can duplicate <color_yellow>Hell Wave Cannon</color> after you cast it.",
    "spell_class": "NONE",
    "valid_targets": [ "ground" ],
    "effect": "summon",
    "effect_str": "mon_utsuho_minisun",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_duration": { "math": [ "var_blacksun_dur" ] },
    "max_duration": 24000,
    "min_aoe": 4,
    "max_aoe": 4,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS" ],
    "//": "The vars are set at utsuho_opens_spellbook_eoc "
  },
  {
    "id": "utsuho_blacksun2_unc",
    "type": "SPELL",
    "name": { "str": "Create black sun <color_yellow>(uncontrollable)</color>" },
    "description": "Snap your fingers to create a nearby black sun that produces some light.  These can duplicate Hell Wave Cannon after you cast it.",
    "spell_class": "NONE",
    "valid_targets": [ "ground" ],
    "effect": "summon",
    "effect_str": "mon_utsuho_minisun",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_duration": { "math": [ "( var_blacksun_dur * 0.25 )" ] },
    "max_duration": { "math": [ "( var_blacksun_dur * 2 )" ] },
    "min_aoe": 4,
    "max_aoe": 4,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "RANDOM_DURATION" ]
  },
  {
    "id": "utsuho_detectrad",
    "type": "SPELL",
    "name": { "str": "Detect radiation" },
    "description": "Concentrate for a while to sense nearby sources of radiation.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_detectrad_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 300,
    "base_energy_cost": 50,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "She regains rand(50) mana if she casts this without the third rod"
  },
  {
    "id": "utsuho_detectrad2",
    "type": "SPELL",
    "name": { "str": "Detect radiation (monsters)" },
    "description": "Detects monsters",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "hostile", "ally" ],
    "targeted_monster_ids": [
      "mon_dks_emissary_plague",
      "mon_science_bot",
      "mon_hazmatbot",
      "mon_zombie_hazmat",
      "mon_charred_nightmare",
      "mon_irradiated_wanderer_1",
      "mon_irradiated_wanderer_2",
      "mon_irradiated_wanderer_3",
      "mon_irradiated_wanderer_4"
    ],
    "effect": "attack",
    "shape": "blast",
    "max_level": 1,
    "min_aoe": 32,
    "max_aoe": 32,
    "field_id": "fd_clairvoyant2",
    "field_chance": 1,
    "min_field_intensity": 1,
    "max_field_intensity": 1,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "difficulty": -12,
    "energy_source": "MANA",
    "flags": [ "IGNORE_WALLS", "NO_HANDS", "NO_LEGS", "NO_EXPLOSION_SFX", "NO_PROJECTILE", "SILENT" ]
  },
  {
    "id": "utsuho_fissionaura",
    "type": "SPELL",
    "name": { "str": "Fission aura" },
    "description": "Partially reduce fission controllers, greatly increasing the thermal energy you emit.  Drains energy while active.  Cast again to toggle OFF.",
    "//description": "OLD: Increase the flux of energy inside you.  After some time, critical mass will be reached, and the energy will be released in several waves, dealing Fire damage to anything creature in the aoe.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_fissionaura_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 100,
    "base_energy_cost": 66,
    "//costs": "OLD: 200 and 166",
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "I'm pretty sure I had already added this... maybe I forgot to actually push it idk",
    "//2": "Yup, forgot to push it. Abyss nova had a queue'd ramp up of 5 s, then dealt 8 waves of damage every 1 s, (7 + 1.8) - 25 dmg per wave, (2 + 1) - 12 pierce, aoe 5. It also added a ms slow (effect -> ench SPEED mutiply -0.5)"
  },
  {
    "id": "utsuho_fissionaura2",
    "type": "SPELL",
    "name": { "str": "Fission aura (dmg)" },
    "description": "Damage component for utsuho_fissionaura ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": { "math": [ "var_fissionaura_dmg" ] },
    "max_damage": { "math": [ "var_fissionaura_dmg" ] },
    "min_pierce": { "math": [ "( (u_skill('dodge') * 0.625 ) - 0.25 )" ] },
    "max_pierce": 6,
    "min_aoe": 4,
    "max_aoe": 4,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_LEGS", "SOMATIC" ],
    "//": "The vars are set at utsuho_opens_spellbook_eoc . min pierce 1; dmg every 3 s"
  },
  {
    "id": "utsuho_fissionaura2_unc",
    "type": "SPELL",
    "name": { "str": "Fission aura (dmg) <color_yellow>(uncontrollable)</color>" },
    "description": "Damage component for utsuho_fissionaura ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": 0,
    "max_damage": { "math": [ "( var_fissionaura_dmg * 2 )" ] },
    "min_aoe": 1,
    "max_aoe": 7,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_LEGS", "SOMATIC", "RANDOM_AOE", "RANDOM_DAMAGE" ],
    "//": "It also costs more mana per cycle, and cycles randomly (see utsuho_fissionaura_cycle1_unc )"
  },
  {
    "id": "utsuho_groundmelt",
    "type": "SPELL",
    "name": { "str": "Ground melt" },
    "description": "Scorch the targeted location with your control rod, infusing it with nuclear power and causing it to rapidly melt into lava.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_groundmelt_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 266,
    "base_energy_cost": 266,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "She regains 266 mana if she casts this without the third rod"
  },
  {
    "id": "utsuho_groundmelt2",
    "type": "SPELL",
    "name": { "str": "Ground melt" },
    "description": "Scorch the targeted location with your control rod, infusing it with nuclear power and causing it to rapidly melt into lava.",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "ter_transform",
    "effect_str": "groundmelt_ter",
    "shape": "blast",
    "min_range": { "math": [ "( (u_skill('dodge') * 0.75 ) + 4.5 )" ] },
    "max_range": 12,
    "min_aoe": { "math": [ "( (u_skill('dodge') * 0.5 ) )" ] },
    "max_aoe": 5,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_LEGS", "NO_PROJECTILE" ],
    "//": "min range 6, min aoe 1"
  },
  {
    "id": "utsuho_hellcannon",
    "type": "SPELL",
    "name": { "str": "<color_yellow>Hell Wave Cannon</color>" },
    "description": "Shoot a beam of solar energy, dealing damage to any affected enemy in the path.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_hellcannon_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 200,
    "base_energy_cost": 100,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "The mechanism on how mon_utsuho_minisun duplicate the spell, the spell data, and so on are present at touhou_utsuho_hellcannon.json "
  },
  {
    "id": "utsuho_hellcannon2",
    "type": "SPELL",
    "name": { "str": "<color_yellow>Hell Wave Cannon</color>" },
    "description": "Shoot a beam of solar energy, dealing damage to any affected enemy in the path.",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "attack",
    "shape": "line",
    "damage_type": "heat",
    "min_damage": { "math": [ "var_hellcannon_dmg" ] },
    "max_damage": 297,
    "min_range": { "math": [ "var_hellcannon_range" ] },
    "max_range": 24,
    "field_id": "fd_laser",
    "field_chance": 1,
    "min_field_intensity": 1,
    "max_field_intensity": 1,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS" ],
    "//note": "This spell should have its range set to maximum, stopping only with walls or obstacles, going past any enemy targeted closer than its max range",
    "//": "The vars are set at utsuho_opens_spellbook_eoc "
  },
  {
    "id": "utsuho_hellcannon2_unc",
    "type": "SPELL",
    "name": { "str": "<color_yellow>Hell Wave Cannon</color> <color_yellow>(uncontrollable)</color>" },
    "description": "Shoot a beam of solar energy, dealing damage to any affected enemy in the path.",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "attack",
    "shape": "line",
    "damage_type": "heat",
    "min_damage": 0,
    "max_damage": { "math": [ "( var_hellcannon_dmg * 2 )" ] },
    "min_range": { "math": [ "var_hellcannon_range" ] },
    "max_range": 24,
    "field_id": "fd_laser",
    "field_chance": 1,
    "min_field_intensity": 1,
    "max_field_intensity": 1,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "RANDOM_DAMAGE" ]
  },
  {
    "id": "utsuho_nuke",
    "type": "SPELL",
    "name": { "str": "Nuclear explosion (fission)" },
    "description": "Yeah.  <color_yellow>Be careful to not get caught in the blast!</color>",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_nuke_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 366,
    "base_energy_cost": 800,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "She regains 800 mana if she casts this without the third rod"
  },
  {
    "id": "utsuho_nuke2",
    "type": "SPELL",
    "name": { "str": "Nuclear explosion (fission)" },
    "description": "Yeah.  Be careful to not get caught in the blast!",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "field", "ground", "hostile", "item", "self" ],
    "effect": "attack",
    "extra_effects": [ { "id": "utsuho_nuke3" }, { "id": "utsuho_nuke3_2" } ],
    "shape": "blast",
    "damage_type": "pure",
    "min_damage": { "math": [ "var_utsuho_nuke" ] },
    "max_damage": 420,
    "min_range": 32,
    "max_range": 32,
    "min_aoe": 6,
    "max_aoe": 6,
    "min_duration": 500,
    "max_duration": 500,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "CONCENTRATE", "NO_EXPLOSION_SFX", "LOUD" ],
    "//": "The destructive effect is diminished only by the fact I don't know how to automatically center the camera on the aoe",
    "//2": "The vars are set at utsuho_opens_spellbook_eoc "
  },
  {
    "id": "utsuho_nuke3_2",
    "type": "SPELL",
    "name": { "str": "Nuclear explosion (fission) (glassing)" },
    "description": "Glassing effect for utsuho_nuke ",
    "spell_class": "NONE",
    "valid_targets": [ "ground" ],
    "effect": "ter_transform",
    "effect_str": "nukeglassing_ter",
    "shape": "blast",
    "min_aoe": 7,
    "max_aoe": 7,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "SILENT" ]
  },
  {
    "id": "utsuho_nuke3",
    "type": "SPELL",
    "name": { "str": "Nuclear explosion (fission) (2nd dmg instance)" },
    "description": "Heat damage instance for utsuho_nuke ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "field", "ground", "hostile", "item", "self" ],
    "effect": "attack",
    "extra_effects": [ { "id": "utsuho_nuke4" } ],
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": { "math": [ "var_utsuho_nuke" ] },
    "max_damage": 420,
    "min_range": 32,
    "max_range": 32,
    "min_aoe": 9,
    "max_aoe": 9,
    "min_duration": 500,
    "max_duration": 500,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 100,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX" ]
  },
  {
    "id": "utsuho_nuke4",
    "type": "SPELL",
    "name": { "str": "Nuclear explosion (fission) (3rd instance)" },
    "description": "Terrain damage instance for utsuho_nuke ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "field", "ground", "hostile", "item", "self" ],
    "effect": "attack",
    "extra_effects": [ 
      { "id": "utsuho_nuke5" }, 
      { "id": "utsuho_nuke5" }, 
      { "id": "utsuho_nuke5" } 
    ],
    "shape": "blast",
    "damage_type": "bash",
    "min_damage": { "math": [ "var_utsuho_nuke" ] },
    "max_damage": 420,
    "min_range": 32,
    "max_range": 32,
    "min_aoe": 12,
    "max_aoe": 12,
    "min_duration": 450,
    "max_duration": 450,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 33,
    "base_energy_cost": 0,
    "energy_source": "MANA"
  },
  {
    "id": "utsuho_nuke5",
    "type": "SPELL",
    "name": { "str": "Nuclear explosion (fission) (bash)" },
    "description": "Bash effect for utsuho_nuke ",
    "spell_class": "NONE",
    "valid_targets": [ "field", "ground", "item" ],
    "effect": "bash",
    "shape": "blast",
    "damage_type": "bash",
    "min_damage": { "math": [ "var_utsuho_nuke" ] },
    "max_damage": 420,
    "min_range": 32,
    "max_range": 32,
    "min_aoe": 12,
    "max_aoe": 12,
    "min_duration": 400,
    "max_duration": 400,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "SILENT" ],
    "//": "This is repeated x3 to allow the bash dmg to hit several times instead of just once"
  },
  {
    "id": "utsuho_ugeyser",
    "type": "SPELL",
    "name": { "str": "Subterranean geyser" },
    "description": "Trigger a small geyser at the location, which emerges after a brief delay, dealing some damage to hostile creatures and pushing anything caught in the area.  It's not subterranean anymore, is it?",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "utsuho_ugeyser_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 66,
    "base_energy_cost": 100,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "SOMATIC", "NO_PROJECTILE" ]
  },
  {
    "id": "utsuho_ugeyser2",
    "type": "SPELL",
    "name": { "str": "Subterranean geyser" },
    "description": "Trigger a small geyser at the location, dealing some damage to hostile creatures and pushing anything caught in the area.  It's not subterranean anymore, is it?",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "attack",
    "extra_effects": [ { "id": "utsuho_ugeyser3" } ],
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": { "math": [ "var_ugeyser_dmg" ] },
    "max_damage": 75,
    "min_pierce": { "math": [ "var_ugeyser_pierce" ] },
    "max_pierce": 19,
    "min_range": 8,
    "max_range": 8,
    "min_aoe": 2,
    "max_aoe": 2,
    "field_id": "fd_fog",
    "field_chance": 1,
    "min_field_intensity": 1,
    "max_field_intensity": 1,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "SOMATIC" ],
    "//": "The vars are set at utsuho_opens_spellbook_eoc . The pierce exists to emulate steam and rock dmg. No friendly fire because"
  },
  {
    "id": "utsuho_ugeyser2_unc",
    "type": "SPELL",
    "name": { "str": "Subterranean geyser <color_yellow>(uncontrollable)</color>" },
    "description": "Trigger a small geyser at the location, dealing some damage to hostile creatures and pushing anything caught in the area.  It's not subterranean anymore, is it?",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "attack",
    "extra_effects": [ { "id": "utsuho_ugeyser3" } ],
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": 1,
    "max_damage": { "math": [ "( var_ugeyser_dmg * 2 )" ] },
    "min_pierce": { "math": [ "( var_ugeyser_pierce / 2 )" ] },
    "max_pierce": { "math": [ "( var_ugeyser_pierce / 2 )" ] },
    "min_range": 8,
    "max_range": 8,
    "min_aoe": 1,
    "max_aoe": 3,
    "field_id": "fd_fog",
    "field_chance": 1,
    "min_field_intensity": 1,
    "max_field_intensity": 1,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_LEGS", "SOMATIC", "RANDOM_AOE", "RANDOM_DAMAGE" ]
  },
  {
    "id": "utsuho_ugeyser3",
    "type": "SPELL",
    "name": { "str": "Subterranean geyser (stun)" },
    "description": "Stun component for utsuho_ugeyser . This is a qol buff so the targets don't immediately move again after the knockback",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "mod_moves",
    "extra_effects": [ { "id": "utsuho_ugeyser4" } ],
    "shape": "cone",
    "damage_type": "pure",
    "min_damage": -100,
    "max_damage": -100,
    "min_range": 8,
    "max_range": 8,
    "min_aoe": 2,
    "max_aoe": 2,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "SILENT" ]
  },
  {
    "id": "utsuho_ugeyser4",
    "type": "SPELL",
    "name": { "str": "Subterranean geyser (knockback)" },
    "description": "Knockback component for utsuho_geyser ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "field", "ground", "hostile", "item", "self" ],
    "effect": "directed_push",
    "shape": "blast",
    "damage_type": "pure",
    "min_damage": { "math": [ "( (u_skill('dodge') * 0.5 ) + 1 )" ] },
    "max_damage": 6,
    "min_aoe": 2,
    "max_aoe": 2,
    "max_level": 1,
    "difficulty": -12,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "RANDOM_DAMAGE" ],
    "//2": "min dmg 2"
  }
]
