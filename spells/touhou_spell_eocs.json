[
    {
    "id": "udonge_waveinsight_start",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
    "effect": [
        { "arithmetic": [ { "u_val": "var", "var_name": "var_waveinsight" }, "++" ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveperception" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavestealth" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_mfortitude" },
		{ "u_lose_effect": "udonge_perception" },
		{ "u_lose_effect": "udonge_stealth" },
		{ "run_eocs": [ "udonge_waveinsight_cycle1" ] }
    ],
	"//": "This always activates every time the spell is cast (condition is a placeholder). It sets var_waveinsight > 0 to signal the aura is ON. It also sets the other auras OFF"
    },
    {
    "id": "udonge_waveinsight_cycle1",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_waveinsight" }, "<", { "const": 2 } ] },
    "effect": [
		{ "run_eocs": [ "udonge_waveinsight_cycle2" ] }
    ],
    "false_effect": { "run_eocs": "udonge_waveinsight_toggle" },
	"//": "This is immediately checked after the previous eoc: if the player has casted the spell just once then var_waveinsight < 2, so cycle2 is run. However, if the player has casted the spell twice then var_waveinsight >= 2, so it runs the toggle instead"
    },
	{
    "id": "udonge_waveinsight_cycle2",
	"type": "effect_on_condition",
    "condition": { 
		"and": [ 
			{ "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
			{ "compare_int": [ { "u_val": "var", "var_name": "var_waveinsight" }, ">", { "const": 0 } ] }
		]
	},
    "effect": [
		{ "arithmetic": [ { "u_val": "mana" }, "-=", { "const": 1 } ] },
		{ "u_add_effect": "udonge_insight", "duration": "3 s" },
		{ "queue_eocs": [ "udonge_waveinsight_cycle1" ], "time_in_future": "2 s" }
    ],
    "false_effect": { "run_eocs": "udonge_wave_oom" }
	},
	{
    "id": "udonge_waveinsight_toggle",
	"type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_waveinsight" }, ">=", { "const": 2 } ] },
    "effect": [
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveinsight" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_insight" }
    ]
	},
	{
    "id": "udonge_wave_oom",
	"type": "effect_on_condition",
	"condition": { "compare_int": [ { "u_val": "mana" }, "<=", { "const": 99 } ] },
    "effect": [
		{ "u_message": "You are too mentally exhausted!  You lose focus of the wavelengths.", "type": "mixed" },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveinsight" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_insight" },
		{ "u_lose_effect": "udonge_mfortitude" },
		{ "u_lose_effect": "udonge_perception" },
		{ "u_lose_effect": "udonge_stealth" }
    ]
	},
    {
    "id": "udonge_wavemfortitude_start",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
    "effect": [
        { "arithmetic": [ { "u_val": "var", "var_name": "var_waveinsight" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, "++" ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveperception" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavestealth" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_insight" },
		{ "u_lose_effect": "udonge_perception" },
		{ "u_lose_effect": "udonge_stealth" },
		{ "run_eocs": [ "udonge_wavemfortitude_cycle1" ] }
    ]
    },
    {
    "id": "udonge_wavemfortitude_cycle1",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, "<", { "const": 2 } ] },
    "effect": [
		{ "run_eocs": [ "udonge_wavemfortitude_cycle2" ] }
    ],
    "false_effect": { "run_eocs": "udonge_wavemfortitude_toggle" }
    },
	{
    "id": "udonge_wavemfortitude_cycle2",
	"type": "effect_on_condition",
    "condition": { 
		"and": [ 
			{ "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
			{ "compare_int": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, ">", { "const": 0 } ] }
		]
	},
    "effect": [
		{ "arithmetic": [ { "u_val": "mana" }, "-=", { "const": 7 } ] },
		{ "u_add_effect": "udonge_mfortitude", "duration": "3 s" },
		{ "queue_eocs": [ "udonge_wavemfortitude_cycle1" ], "time_in_future": "2 s" }
    ],
    "false_effect": { "run_eocs": "udonge_wave_oom" }
	},
	{
    "id": "udonge_wavemfortitude_toggle",
	"type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, ">=", { "const": 2 } ] },
    "effect": [
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_mfortitude" }
    ]
	},
    {
    "id": "udonge_waveperception_start",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
    "effect": [
        { "arithmetic": [ { "u_val": "var", "var_name": "var_waveinsight" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveperception" }, "++" ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavestealth" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_insight" },
		{ "u_lose_effect": "udonge_mfortitude" },
		{ "u_lose_effect": "udonge_stealth" },
		{ "run_eocs": [ "udonge_waveperception_cycle1" ] }
    ]
    },
    {
    "id": "udonge_waveperception_cycle1",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_waveperception" }, "<", { "const": 2 } ] },
    "effect": [
		{ "run_eocs": [ "udonge_waveperception_cycle2" ] }
    ],
    "false_effect": { "run_eocs": "udonge_waveperception_toggle" }
    },
	{
    "id": "udonge_waveperception_cycle2",
	"type": "effect_on_condition",
    "condition": { 
		"and": [ 
			{ "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
			{ "compare_int": [ { "u_val": "var", "var_name": "var_waveperception" }, ">", { "const": 0 } ] }
		]
	},
    "effect": [
		{ "arithmetic": [ { "u_val": "mana" }, "-=", { "const": 8 } ] },
		{ "u_add_effect": "udonge_perception", "duration": "3 s" },
		{ "queue_eocs": [ "udonge_waveperception_cycle1" ], "time_in_future": "2 s" }
    ],
    "false_effect": { "run_eocs": "udonge_wave_oom" }
	},
	{
    "id": "udonge_waveperception_toggle",
	"type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_waveperception" }, ">=", { "const": 2 } ] },
    "effect": [
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveperception" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_perception" }
    ]
	},
    {
    "id": "udonge_wavestealth_start",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
    "effect": [
        { "arithmetic": [ { "u_val": "var", "var_name": "var_waveinsight" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavemfortitude" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_waveperception" }, "=", { "const": 0 } ] },
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavestealth" }, "++" ] },
		{ "u_lose_effect": "udonge_insight" },
		{ "u_lose_effect": "udonge_mfortitude" },
		{ "u_lose_effect": "udonge_perception" },
		{ "run_eocs": [ "udonge_wavestealth_cycle1" ] }
    ]
    },
    {
    "id": "udonge_wavestealth_cycle1",
    "type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_wavestealth" }, "<", { "const": 2 } ] },
    "effect": [
		{ "run_eocs": [ "udonge_wavestealth_cycle2" ] }
    ],
    "false_effect": { "run_eocs": "udonge_wavestealth_toggle" }
    },
	{
    "id": "udonge_wavestealth_cycle2",
	"type": "effect_on_condition",
    "condition": { 
		"and": [ 
			{ "compare_int": [ { "u_val": "mana" }, ">=", { "const": 100 } ] },
			{ "compare_int": [ { "u_val": "var", "var_name": "var_wavestealth" }, ">", { "const": 0 } ] }
		]
	},
    "effect": [
		{ "arithmetic": [ { "u_val": "mana" }, "-=", { "const": 11 } ] },
		{ "u_add_effect": "udonge_stealth", "duration": "3 s" },
		{ "queue_eocs": [ "udonge_wavestealth_cycle1" ], "time_in_future": "2 s" }
    ],
    "false_effect": { "run_eocs": "udonge_wave_oom" }
	},
	{
    "id": "udonge_wavestealth_toggle",
	"type": "effect_on_condition",
    "condition": { "compare_int": [ { "u_val": "var", "var_name": "var_wavestealth" }, ">=", { "const": 2 } ] },
    "effect": [
		{ "arithmetic": [ { "u_val": "var", "var_name": "var_wavestealth" }, "=", { "const": 0 } ] },
		{ "u_lose_effect": "udonge_stealth" }
    ]
	}
]